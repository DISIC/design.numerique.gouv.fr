{"version":3,"file":"navigation.nomodule.js","sources":["../../../.config/config.js","../../../src/core/api.js","../../../src/component/navigation/script/navigation/navigation-selector.js","../../../src/component/navigation/script/navigation/navigation-item.js","../../../src/component/navigation/script/navigation/navigation-mouse-position.js","../../../src/component/navigation/script/navigation/navigation.js","../../../src/component/navigation/index.js","../../../src/component/navigation/main.js"],"sourcesContent":["const config = {\r\n  prefix: 'fr',\r\n  namespace: 'dsfr',\r\n  organisation: '@gouvfr',\r\n  version: '1.11.2'\r\n};\r\n\r\nexport default config;\r\n","import config from './config.js';\nconst api = window[config.namespace];\nexport default api;\n","import api from '../../api.js';\n\nconst ITEM = api.internals.ns.selector('nav__item');\nconst COLLAPSE = api.internals.ns.selector('collapse');\n\nexport const NavigationSelector = {\n  NAVIGATION: api.internals.ns.selector('nav'),\n  COLLAPSE: `${ITEM} > ${COLLAPSE}, ${ITEM} > *:not(${ITEM}):not(${COLLAPSE}) > ${COLLAPSE}, ${ITEM} > *:not(${ITEM}):not(${COLLAPSE}) > *:not(${ITEM}):not(${COLLAPSE}) > ${COLLAPSE}`,\n  COLLAPSE_LEGACY: `${ITEM} ${COLLAPSE}`,\n  ITEM: ITEM,\n  ITEM_RIGHT: `${ITEM}--align-right`,\n  MENU: api.internals.ns.selector('menu'),\n  BUTTON: api.internals.ns.selector('nav__btn'),\n  TRANSLATE_BUTTON: api.internals.ns.selector('translate__btn')\n};\n","import api from '../../api.js';\nimport { NavigationSelector } from './navigation-selector.js';\n\nclass NavigationItem extends api.core.Instance {\n  constructor () {\n    super();\n    this._isRightAligned = false;\n  }\n\n  static get instanceClassName () {\n    return 'NavigationItem';\n  }\n\n  init () {\n    this.addAscent(api.core.DisclosureEmission.ADDED, this.calculate.bind(this));\n    this.addAscent(api.core.DisclosureEmission.REMOVED, this.calculate.bind(this));\n    this.isResizing = true;\n    this.calculate();\n  }\n\n  resize () {\n    this.calculate();\n  }\n\n  calculate () {\n    const collapse = this.element.getDescendantInstances(api.core.Collapse.instanceClassName, null, true)[0];\n    if (collapse && this.isBreakpoint(api.core.Breakpoints.LG) && collapse.element.node.matches(NavigationSelector.MENU)) {\n      const right = this.element.node.parentElement.getBoundingClientRect().right; // todo: ne fonctionne que si la nav fait 100% du container\n      const width = collapse.element.node.getBoundingClientRect().width;\n      const left = this.element.node.getBoundingClientRect().left;\n      this.isRightAligned = left + width > right;\n    } else this.isRightAligned = false;\n  }\n\n  get isRightAligned () {\n    return this._isRightAligned;\n  }\n\n  set isRightAligned (value) {\n    if (this._isRightAligned === value) return;\n    this._isRightAligned = value;\n    if (value) api.internals.dom.addClass(this.element.node, NavigationSelector.ITEM_RIGHT);\n    else api.internals.dom.removeClass(this.element.node, NavigationSelector.ITEM_RIGHT);\n  }\n\n  get collapsePrimary () {\n    const buttons = this.element.children.map(child => child.getInstance('CollapseButton')).filter(button => button !== null && (button.hasClass(NavigationSelector.BUTTON) || button.hasClass(NavigationSelector.TRANSLATE_BUTTON)));\n    return buttons[0];\n  }\n}\n\nexport { NavigationItem };\n","export const NavigationMousePosition = {\n  NONE: -1,\n  INSIDE: 0,\n  OUTSIDE: 1\n};\n","import api from '../../api.js';\nimport { NavigationSelector } from './navigation-selector.js';\nimport { NavigationMousePosition } from './navigation-mouse-position.js';\n\nclass Navigation extends api.core.CollapsesGroup {\n  static get instanceClassName () {\n    return 'Navigation';\n  }\n\n  init () {\n    super.init();\n    this.clicked = false;\n    this.out = false;\n    this.addEmission(api.core.RootEmission.CLICK, this._handleRootClick.bind(this));\n    this.listen('mousedown', this.handleMouseDown.bind(this));\n    this.listenClick({ capture: true });\n    this.isResizing = true;\n  }\n\n  validate (member) {\n    return super.validate(member) && member.element.node.matches(api.internals.legacy.isLegacy ? NavigationSelector.COLLAPSE_LEGACY : NavigationSelector.COLLAPSE);\n  }\n\n  handleMouseDown (e) {\n    if (!this.isBreakpoint(api.core.Breakpoints.LG) || this.index === -1 || !this.current) return;\n    this.position = this.current.node.contains(e.target) ? NavigationMousePosition.INSIDE : NavigationMousePosition.OUTSIDE;\n    this.requestPosition();\n  }\n\n  handleClick (e) {\n    if (e.target.matches('a, button') && !e.target.matches('[aria-controls]') && !e.target.matches(api.core.DisclosureSelector.PREVENT_CONCEAL)) {\n      this.index = -1;\n    }\n  }\n\n  _handleRootClick (target) {\n    if (!this.isBreakpoint(api.core.Breakpoints.LG)) return;\n    if (!this.node.contains(target)) {\n      this.out = true;\n      this.requestPosition();\n    }\n  }\n\n  requestPosition () {\n    if (this.isRequesting) return;\n    this.isRequesting = true;\n    this.request(this.getPosition.bind(this));\n  }\n\n  getPosition () {\n    if (this.out) {\n      switch (this.position) {\n        case NavigationMousePosition.OUTSIDE:\n          this.index = -1;\n          break;\n\n        case NavigationMousePosition.INSIDE:\n          if (this.current && !this.current.node.contains(document.activeElement)) this.current.focus();\n          break;\n\n        default:\n          if (this.index > -1 && !this.current.hasFocus) this.index = -1;\n      }\n    }\n\n    this.request(this.requested.bind(this));\n  }\n\n  requested () {\n    this.position = NavigationMousePosition.NONE;\n    this.out = false;\n    this.isRequesting = false;\n  }\n\n  get index () { return super.index; }\n\n  set index (value) {\n    if (value === -1 && this.current && this.current.hasFocus) this.current.focus();\n    super.index = value;\n  }\n\n  get canUngroup () {\n    return !this.isBreakpoint(api.core.Breakpoints.LG);\n  }\n\n  resize () {\n    this.update();\n  }\n}\n\nexport { Navigation };\n","import api from './api.js';\nimport { NavigationItem } from './script/navigation/navigation-item.js';\nimport { Navigation } from './script/navigation/navigation.js';\nimport { NavigationSelector } from './script/navigation/navigation-selector.js';\nimport { NavigationMousePosition } from './script/navigation/navigation-mouse-position.js';\n\napi.navigation = {\n  Navigation: Navigation,\n  NavigationItem: NavigationItem,\n  NavigationMousePosition: NavigationMousePosition,\n  NavigationSelector: NavigationSelector\n};\n\nexport default api;\n","import api from './index.js';\n\napi.internals.register(api.navigation.NavigationSelector.NAVIGATION, api.navigation.Navigation);\napi.internals.register(api.navigation.NavigationSelector.ITEM, api.navigation.NavigationItem);\n\nexport default api;\n"],"names":["const","super"],"mappings":"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"}